var nv=window.nv||{};window.nv=nv;nv.dev=false;nv.tooltip=nv.tooltip||{};nv.utils=nv.utils||{};nv.models=nv.models||{};nv.charts={};nv.graphs=[];nv.logs={};nv.dispatch=d3.dispatch("render_start","render_end");if(!Function.prototype.bind){Function.prototype.bind=function(a){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var f=Array.prototype.slice.call(arguments,1),e=this,b=function(){},c=function(){return e.apply(this instanceof b&&a?this:a,f.concat(Array.prototype.slice.call(arguments)))};b.prototype=this.prototype;c.prototype=new b();return c}}if(nv.dev){nv.dispatch.on("render_start",function(a){nv.logs.startTime=+new Date()});nv.dispatch.on("render_end",function(a){nv.logs.endTime=+new Date();nv.logs.totalTime=nv.logs.endTime-nv.logs.startTime;nv.log("total",nv.logs.totalTime)})}nv.log=function(){if(nv.dev&&window.console&&console.log&&console.log.apply){console.log.apply(console,arguments)}else{if(nv.dev&&window.console&&typeof console.log=="function"&&Function.prototype.bind){var a=Function.prototype.bind.call(console.log,console);a.apply(console,arguments)}}return arguments[arguments.length-1]};nv.deprecated=function(a){if(nv.dev&&console&&console.warn){console.warn("`"+a+"` has been deprecated.")}};nv.render=function render(a){a=a||1;nv.render.active=true;nv.dispatch.render_start();setTimeout(function(){var c,e;for(var b=0;b<a&&(e=nv.render.queue[b]);b++){c=e.generate();if(typeof e.callback==typeof(Function)){e.callback(c)}nv.graphs.push(c)}nv.render.queue.splice(0,b);if(nv.render.queue.length){setTimeout(arguments.callee,0)}else{nv.dispatch.render_end();nv.render.active=false}},0)};nv.render.active=false;nv.render.queue=[];nv.addGraph=function(a){if(typeof arguments[0]===typeof(Function)){a={generate:arguments[0],callback:arguments[1]}}nv.render.queue.push(a);if(!nv.render.active){nv.render()}};nv.interactiveGuideline=function(){var l=nv.models.tooltip();var a=null;var k=null;var c={left:0,top:0},j=d3.scale.linear(),b=d3.scale.linear(),g=d3.dispatch("elementMousemove","elementMouseout","elementClick","elementDblclick"),h=true;var f=null;var i="ActiveXObject" in window;function e(m){m.each(function(q){var n=d3.select(this);var p=(a||960),s=(k||400);var o=n.selectAll("g.nv-wrap.nv-interactiveLineLayer").data([q]);var t=o.enter().append("g").attr("class"," nv-wrap nv-interactiveLineLayer");t.append("g").attr("class","nv-interactiveGuideLine");if(!f){return}function r(){var x=d3.mouse(this);var w=x[0];var v=x[1];var y=true;var z=false;if(i){w=d3.event.offsetX;v=d3.event.offsetY;if(d3.event.target.tagName!=="svg"){y=false}if(d3.event.target.className.baseVal.match("nv-legend")){z=true}}if(y){w-=c.left;v-=c.top}if(w<0||v<0||w>p||v>s||(d3.event.relatedTarget&&d3.event.relatedTarget.ownerSVGElement===undefined)||z){if(i){if(d3.event.relatedTarget&&d3.event.relatedTarget.ownerSVGElement===undefined&&d3.event.relatedTarget.className.match(l.nvPointerEventsClass)){return}}g.elementMouseout({mouseX:w,mouseY:v});e.renderGuideLine(null);return}var u=j.invert(w);g.elementMousemove({mouseX:w,mouseY:v,pointXValue:u});if(d3.event.type==="dblclick"){g.elementDblclick({mouseX:w,mouseY:v,pointXValue:u})}if(d3.event.type==="click"){g.elementClick({mouseX:w,mouseY:v,pointXValue:u})}}f.on("mousemove",r,true).on("mouseout",r,true).on("dblclick",r).on("click",r);e.renderGuideLine=function(u){if(!h){return}var v=o.select(".nv-interactiveGuideLine").selectAll("line").data((u!=null)?[nv.utils.NaNtoZero(u)]:[],String);v.enter().append("line").attr("class","nv-guideline").attr("x1",function(w){return w}).attr("x2",function(w){return w}).attr("y1",s).attr("y2",0);v.exit().remove()}})}e.dispatch=g;e.tooltip=l;e.margin=function(m){if(!arguments.length){return c}c.top=typeof m.top!="undefined"?m.top:c.top;c.left=typeof m.left!="undefined"?m.left:c.left;return e};e.width=function(m){if(!arguments.length){return a}a=m;return e};e.height=function(m){if(!arguments.length){return k}k=m;return e};e.xScale=function(m){if(!arguments.length){return j}j=m;return e};e.showGuideLine=function(m){if(!arguments.length){return h}h=m;return e};e.svgContainer=function(m){if(!arguments.length){return f}f=m;return e};return e};nv.interactiveBisect=function(c,b,h){if(!(c instanceof Array)){return null}if(typeof h!=="function"){h=function(k,j){return k.x}}var i=d3.bisector(h).left;var e=d3.max([0,i(c,b)-1]);var g=h(c[e],e);if(typeof g==="undefined"){g=e}if(g===b){return e}var a=d3.min([e+1,c.length-1]);var f=h(c[a],a);if(typeof f==="undefined"){f=a}if(Math.abs(f-b)>=Math.abs(g-b)){return e}else{return a}};nv.nearestValueIndex=function(c,b,a){var f=Infinity,e=null;c.forEach(function(h,g){var j=Math.abs(b-h);if(j<=f&&j<a){f=j;e=g}});return e};(function(){window.nv.tooltip={};window.nv.models.tooltip=function(){var p=null;var u=null;var f="w",e=50,m=25,b=null,r=null,q=null,k=null,t={left:null,top:null},j=true;var n="nvtooltip-"+Math.floor(Math.random()*100000);var h="nv-pointer-events-none";var a=function(w,v){return w};var o=function(v){return v};var c=function(z){if(p!=null){return p}if(z==null){return""}var y=d3.select(document.createElement("table"));var v=y.selectAll("thead").data([z]).enter().append("thead");v.append("tr").append("td").attr("colspan",3).append("strong").classed("x-value",true).html(o(z.value));var A=y.selectAll("tbody").data([z]).enter().append("tbody");var w=A.selectAll("tr").data(function(B){return B.series}).enter().append("tr").classed("highlight",function(B){return B.highlight});w.append("td").classed("legend-color-guide",true).append("div").style("background-color",function(B){return B.color});w.append("td").classed("key",true).html(function(B){return B.key});w.append("td").classed("value",true).html(function(C,B){return a(C.value,B)});w.selectAll("td").each(function(D){if(D.highlight){var C=d3.scale.linear().domain([0,1]).range(["#fff",D.color]);var B=0.6;d3.select(this).style("border-bottom-color",C(B)).style("border-top-color",C(B))}});var x=y.node().outerHTML;if(z.footer!==undefined){x+="<div class='footer'>"+z.footer+"</div>"}return x};var g=function(v){if(v&&v.series&&v.series.length>0){return true}return false};function i(){if(q){var v=d3.select(q);if(v.node().tagName!=="svg"){v=v.select("svg")}var x=(v.node())?v.attr("viewBox"):null;if(x){x=x.split(" ");var w=parseInt(v.style("width"))/x[2];t.left=t.left*w;t.top=t.top*w}}}function s(x){var v;if(q){v=d3.select(q)}else{v=d3.select("body")}var w=v.select(".nvtooltip");if(w.node()===null){w=v.append("div").attr("class","nvtooltip "+(r?r:"xy-tooltip")).attr("id",n)}w.node().innerHTML=x;w.style("top",0).style("left",0).style("opacity",0);w.selectAll("div, table, td, tr").classed(h,true);w.classed(h,true);return w.node()}function l(){if(!j){return}if(!g(u)){return}i();var y=t.left;var B=(b!=null)?b:t.top;var x=s(c(u));k=x;if(q){var A=q.getElementsByTagName("svg")[0];var v=(A)?A.getBoundingClientRect():q.getBoundingClientRect();var D={left:0,top:0};if(A){var w=A.getBoundingClientRect();var C=q.getBoundingClientRect();var z=w.top;if(z<0){var E=q.getBoundingClientRect();z=(Math.abs(z)>E.height)?0:z}D.top=Math.abs(z-C.top);D.left=Math.abs(w.left-C.left)}y+=q.offsetLeft+D.left-2*q.scrollLeft;B+=q.offsetTop+D.top-2*q.scrollTop}if(m&&m>0){B=Math.floor(B/m)*m}nv.tooltip.calcTooltipPosition([y,B],f,e,x);return l}l.nvPointerEventsClass=h;l.content=function(v){if(!arguments.length){return p}p=v;return l};l.tooltipElem=function(){return k};l.contentGenerator=function(v){if(!arguments.length){return c}if(typeof v==="function"){c=v}return l};l.data=function(v){if(!arguments.length){return u}u=v;return l};l.gravity=function(v){if(!arguments.length){return f}f=v;return l};l.distance=function(v){if(!arguments.length){return e}e=v;return l};l.snapDistance=function(v){if(!arguments.length){return m}m=v;return l};l.classes=function(v){if(!arguments.length){return r}r=v;return l};l.chartContainer=function(v){if(!arguments.length){return q}q=v;return l};l.position=function(v){if(!arguments.length){return t}t.left=(typeof v.left!=="undefined")?v.left:t.left;t.top=(typeof v.top!=="undefined")?v.top:t.top;return l};l.fixedTop=function(v){if(!arguments.length){return b}b=v;return l};l.enabled=function(v){if(!arguments.length){return j}j=v;return l};l.valueFormatter=function(v){if(!arguments.length){return a}if(typeof v==="function"){a=v}return l};l.headerFormatter=function(v){if(!arguments.length){return o}if(typeof v==="function"){o=v}return l};l.id=function(){return n};return l};nv.tooltip.show=function(i,e,h,g,f,c){var b=document.createElement("div");b.className="nvtooltip "+(c?c:"xy-tooltip");var a=f;if(!f||f.tagName.match(/g|svg/i)){a=document.getElementsByTagName("body")[0]}b.style.left=0;b.style.top=0;b.style.opacity=0;if(typeof e!=="string"){b.appendChild(e)}else{b.innerHTML=e}a.appendChild(b);if(f){i[0]=i[0]-f.scrollLeft;i[1]=i[1]-f.scrollTop}nv.tooltip.calcTooltipPosition(i,h,g,b)};nv.tooltip.findFirstNonSVGParent=function(a){while(a.tagName.match(/^g|svg$/i)!==null){a=a.parentNode}return a};nv.tooltip.findTotalOffsetTop=function(a,c){var b=c;do{if(!isNaN(a.offsetTop)){b+=(a.offsetTop)}}while(a=a.offsetParent);return b};nv.tooltip.findTotalOffsetLeft=function(b,a){var c=a;do{if(!isNaN(b.offsetLeft)){c+=(b.offsetLeft)}}while(b=b.offsetParent);return c};nv.tooltip.calcTooltipPosition=function(n,q,l,b){var p=parseInt(b.offsetHeight),c=parseInt(b.offsetWidth),f=nv.utils.windowSize().width,a=nv.utils.windowSize().height,e=window.pageYOffset,h=window.pageXOffset,g,m;a=window.innerWidth>=document.body.scrollWidth?a:a-16;f=window.innerHeight>=document.body.scrollHeight?f:f-16;q=q||"s";l=l||20;var i=function(r){return nv.tooltip.findTotalOffsetTop(r,m)};var o=function(r){return nv.tooltip.findTotalOffsetLeft(r,g)};switch(q){case"e":g=n[0]-c-l;m=n[1]-(p/2);var k=o(b);var j=i(b);if(k<h){g=n[0]+l>h?n[0]+l:h-k+g}if(j<e){m=e-j+m}if(j+p>e+a){m=e+a-j+m-p}break;case"w":g=n[0]+l;m=n[1]-(p/2);var k=o(b);var j=i(b);if(k+c>f){g=n[0]-c-l}if(j<e){m=e+5}if(j+p>e+a){m=e+a-j+m-p}break;case"n":g=n[0]-(c/2)-5;m=n[1]+l;var k=o(b);var j=i(b);if(k<h){g=h+5}if(k+c>f){g=g-c/2+5}if(j+p>e+a){m=e+a-j+m-p}break;case"s":g=n[0]-(c/2);m=n[1]-p-l;var k=o(b);var j=i(b);if(k<h){g=h+5}if(k+c>f){g=g-c/2+5}if(e>j){m=e}break;case"none":g=n[0];m=n[1]-l;var k=o(b);var j=i(b);break}b.style.left=g+"px";b.style.top=m+"px";b.style.opacity=1;b.style.position="absolute";return b};nv.tooltip.cleanup=function(){var a=document.getElementsByClassName("nvtooltip");var b=[];while(a.length){b.push(a[0]);a[0].style.transitionDelay="0 !important";a[0].style.opacity=0;a[0].className="nvtooltip-pending-removal"}setTimeout(function(){while(b.length){var c=b.pop();c.parentNode.removeChild(c)}},500)}})();nv.utils.windowSize=function(){var a={width:640,height:480};if(document.body&&document.body.offsetWidth){a.width=document.body.offsetWidth;a.height=document.body.offsetHeight}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){a.width=document.documentElement.offsetWidth;a.height=document.documentElement.offsetHeight}if(window.innerWidth&&window.innerHeight){a.width=window.innerWidth;a.height=window.innerHeight}return(a)};nv.utils.windowResize=function(a){if(window.addEventListener){window.addEventListener("resize",a)}else{nv.log("ERROR: Failed to bind to window.resize with: ",a)}return{callback:a,clear:function(){window.removeEventListener("resize",a)}}};nv.utils.getColor=function(a){if(!arguments.length){return nv.utils.defaultColor()}else{if(a instanceof Array){return function(c,b){return c.color||a[b%a.length]}}else{return a}}};nv.utils.defaultColor=function(){var a=d3.scale.category20().range();return function(c,b){return c.color||a[b%a.length]}};nv.utils.customTheme=function(e,b,c){b=b||function(f){return f.key};c=c||d3.scale.category20().range();var a=c.length;return function(h,f){var g=b(h);if(typeof e[g]==="function"){return e[g]()}else{if(e[g]!==undefined){return e[g]}else{if(!a){a=c.length}a=a-1;return c[a]}}}};nv.utils.pjax=function(a,b){var c=function(e){d3.html(e,function(f){var g=d3.select(b).node();g.parentNode.replaceChild(d3.select(f).select(b).node(),g);nv.utils.pjax(a,b)})};d3.selectAll(a).on("click",function(){history.pushState(this.href,this.textContent,this.href);c(this.href);d3.event.preventDefault()});d3.select(window).on("popstate",function(){if(d3.event.state){c(d3.event.state)}})};nv.utils.calcApproxTextWidth=function(a){if(typeof a.style==="function"&&typeof a.text==="function"){var c=parseInt(a.style("font-size").replace("px",""));var b=a.text().length;return b*c*0.5}return 0};nv.utils.NaNtoZero=function(a){if(typeof a!=="number"||isNaN(a)||a===null||a===Infinity||a===-Infinity){return 0}return a};d3.selection.prototype.watchTransition=function(b){var a=[this].concat([].slice.call(arguments,1));return b.transition.apply(b,a)};nv.utils.renderWatch=function(c,e){if(!(this instanceof nv.utils.renderWatch)){return new nv.utils.renderWatch(c,e)}var f=e!==undefined?e:250;var a=[];var b=this;this.models=function(g){g=[].slice.call(arguments,0);g.forEach(function(h){h.__rendered=false;(function(i){i.dispatch.on("renderEnd",function(j){i.__rendered=true;b.renderEnd("model")})})(h);if(a.indexOf(h)<0){a.push(h)}});return this};this.reset=function(g){if(g!==undefined){f=g}a=[]};this.transition=function(h,g,i){g=arguments.length>1?[].slice.call(arguments,1):[];if(g.length>1){i=g.pop()}else{i=f!==undefined?f:250}h.__rendered=false;if(a.indexOf(h)<0){a.push(h)}if(i===0){h.__rendered=true;h.delay=function(){return this};h.duration=function(){return this};return h}else{if(h.length===0){h.__rendered=true}else{if(h.every(function(k){return !k.length})){h.__rendered=true}else{h.__rendered=false}}var j=0;return h.transition().duration(i).each(function(){++j}).each("end",function(l,k){if(--j===0){h.__rendered=true;b.renderEnd.apply(this,g)}})}};this.renderEnd=function(){if(a.every(function(g){return g.__rendered})){a.forEach(function(g){g.__rendered=false});c.renderEnd.apply(this,arguments)}}};nv.utils.deepExtend=function(b){var a=arguments.length>1?[].slice.call(arguments,1):[];a.forEach(function(g){for(key in g){var e=b[key] instanceof Array;var c=typeof b[key]==="object";var f=typeof g[key]==="object";if(c&&!e&&f){nv.utils.deepExtend(b[key],g[key])}else{b[key]=g[key]}}})};nv.utils.state=function(){if(!(this instanceof nv.utils.state)){return new nv.utils.state()}var e={};var b=this;var h=function(){};var c=function(){return{}};var g=null;var f=null;this.dispatch=d3.dispatch("change","set");this.dispatch.on("set",function(i){h(i,true)});this.getter=function(i){c=i;return this};this.setter=function(i,j){if(!j){j=function(){}}h=function(k,l){i(k);if(l){j()}};return this};this.init=function(i){g=g||{};nv.utils.deepExtend(g,i)};var a=function(){var j=c();if(JSON.stringify(j)===JSON.stringify(e)){return false}for(var i in j){if(e[i]===undefined){e[i]={}}e[i]=j[i];f=true}return true};this.update=function(){if(g){h(g,false);g=null}if(a.call(this)){this.dispatch.change(e)}}};nv.utils.optionsFunc=function(a){nv.deprecated("nv.utils.optionsFunc");if(a){d3.map(a).forEach((function(b,c){if(typeof this[b]==="function"){this[b](c)}}).bind(this))}return this};nv.utils.calcTicksX=function(f,e){var a=1;var c=0;for(c;c<e.length;c+=1){var b=e[c]&&e[c].values?e[c].values.length:0;a=b>a?b:a}nv.log("Requested number of ticks: ",f);nv.log("Calculated max values to be: ",a);f=f>a?f=a-1:f;f=f<1?1:f;f=Math.floor(f);nv.log("Calculating tick count as: ",f);return f};nv.utils.calcTicksY=function(b,a){return nv.utils.calcTicksX(b,a)};nv.utils.initOption=function(b,a){if(b._calls&&b._calls[a]){b[a]=b._calls[a]}else{b[a]=function(c){if(!arguments.length){return b._options[a]}b._options[a]=c;return b}}};nv.utils.initOptions=function(e){var c=Object.getOwnPropertyNames(e._options||{});var b=Object.getOwnPropertyNames(e._calls||{});c=c.concat(b);for(var a in c){nv.utils.initOption(e,c[a])}};nv.utils.inheritOptionsD3=function(b,a,c){b._d3options=c.concat(b._d3options||[]);c.unshift(a);c.unshift(b);d3.rebind.apply(this,c)};nv.utils.arrayUnique=function(b){return b.sort().filter(function(a,c){return !c||a!=b[c-1]})};nv.utils.symbolMap=d3.map();nv.utils.symbol=function(){var b,a=64;function c(h,f){var e=b.call(this,h,f);var g=a.call(this,h,f);if(d3.svg.symbolTypes.indexOf(e)!==-1){return d3.svg.symbol().type(e).size(g)()}else{return nv.utils.symbolMap.get(e)(g)}}c.type=function(e){if(!arguments.length){return b}b=d3.functor(e);return c};c.size=function(e){if(!arguments.length){return a}a=d3.functor(e);return c};return c};nv.utils.inheritOptions=function(h,g){var f=Object.getOwnPropertyNames(g._options||{});var e=Object.getOwnPropertyNames(g._calls||{});var a=g._inherited||[];var b=g._d3options||[];var c=f.concat(e).concat(a).concat(b);c.unshift(g);c.unshift(h);d3.rebind.apply(this,c);h._inherited=nv.utils.arrayUnique(f.concat(e).concat(a).concat(f).concat(h._inherited||[]));h._d3options=nv.utils.arrayUnique(b.concat(h._d3options||[]))};nv.utils.initSVG=function(a){a.classed({"nvd3-svg":true})};nv.models.legend=function(){var e={top:5,right:0,bottom:5,left:0},b=400,k=20,g=function(m){return m.key},f=nv.utils.defaultColor(),i=true,c=false,l=true,a=false,h=d3.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout","stateChange");function j(m){m.each(function(G){var n=b-e.left-e.right,y=d3.select(this);nv.utils.initSVG(y);var w=y.selectAll("g.nv-legend").data([G]);var C=w.enter().append("g").attr("class","nvd3 nv-legend").append("g");var F=w.select("g");w.attr("transform","translate("+e.left+","+e.top+")");var x=F.selectAll(".nv-series").data(function(H){return H});var r=x.enter().append("g").attr("class","nv-series").on("mouseover",function(I,H){h.legendMouseover(I,H)}).on("mouseout",function(I,H){h.legendMouseout(I,H)}).on("click",function(I,H){h.legendClick(I,H);if(l){if(a){G.forEach(function(J){J.disabled=true});I.disabled=false}else{I.disabled=!I.disabled;if(G.every(function(J){return J.disabled})){G.forEach(function(J){J.disabled=false})}}h.stateChange({disabled:G.map(function(J){return !!J.disabled})})}}).on("dblclick",function(I,H){h.legendDblclick(I,H);if(l){G.forEach(function(J){J.disabled=true});I.disabled=false;h.stateChange({disabled:G.map(function(J){return !!J.disabled})})}});r.append("circle").style("stroke-width",2).attr("class","nv-legend-symbol").attr("r",5);r.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("dy",".32em").attr("dx","8");x.classed("nv-disabled",function(H){return H.disabled});x.exit().remove();x.select("circle").style("fill",function(I,H){return I.color||f(I,H)}).style("stroke",function(I,H){return I.color||f(I,H)});x.select("text").text(g);if(i){var q=[];x.each(function(L,J){var I=d3.select(this).select("text");var H;try{H=I.node().getComputedTextLength();if(H<=0){throw Error()}}catch(K){H=nv.utils.calcApproxTextWidth(I)}q.push(H+28)});var u=0;var B=0;var z=[];while(B<n&&u<q.length){z[u]=q[u];B+=q[u++]}if(u===0){u=1}while(B>n&&u>1){z=[];u--;for(var D=0;D<q.length;D++){if(q[D]>(z[D%u]||0)){z[D%u]=q[D]}}B=z.reduce(function(I,J,H,K){return I+J})}var o=[];for(var E=0,v=0;E<u;E++){o[E]=v;v+=z[E]}x.attr("transform",function(I,H){return"translate("+o[H%u]+","+(5+Math.floor(H/u)*20)+")"});if(c){F.attr("transform","translate("+(b-e.right-B)+","+e.top+")")}else{F.attr("transform","translate(0,"+e.top+")")}k=e.top+e.bottom+(Math.ceil(q.length/u)*20)}else{var s=5,t=5,A=0,p;x.attr("transform",function(J,H){var I=d3.select(this).select("text").node().getComputedTextLength()+28;p=t;if(b<e.left+e.right+p+I){t=p=5;s+=20}t+=I;if(t>A){A=t}return"translate("+p+","+s+")"});F.attr("transform","translate("+(b-e.right-A)+","+e.top+")");k=e.top+e.bottom+s+15}});return j}j.dispatch=h;j.options=nv.utils.optionsFunc.bind(j);j._options=Object.create({},{width:{get:function(){return b},set:function(m){b=m}},height:{get:function(){return k},set:function(m){k=m}},key:{get:function(){return g},set:function(m){g=m}},align:{get:function(){return i},set:function(m){i=m}},rightAlign:{get:function(){return c},set:function(m){c=m}},updateState:{get:function(){return l},set:function(m){l=m}},radioButtonMode:{get:function(){return a},set:function(m){a=m}},margin:{get:function(){return e},set:function(m){e.top=m.top!==undefined?m.top:e.top;e.right=m.right!==undefined?m.right:e.right;e.bottom=m.bottom!==undefined?m.bottom:e.bottom;e.left=m.left!==undefined?m.left:e.left}},color:{get:function(){return f},set:function(m){f=nv.utils.getColor(m)}}});nv.utils.initOptions(j);return j};nv.models.pie=function(){var n={top:0,right:0,bottom:0,left:0},s=500,o=500,y=function(D){return D.x},x=function(D){return D.y},q=Math.floor(Math.random()*10000),u=nv.utils.defaultColor(),h=d3.format(",.0f"),g=d3.format("%"),p=true,i=true,t=false,B="key",v=0.02,j=false,C=false,z=true,c=0,b=false,w=false,k=false,r=false,e=0,l=0.5,a=250,A=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","renderEnd");var f=nv.utils.renderWatch(A);function m(D){f.reset();D.each(function(ad){var F=s-n.left-n.right,J=o-n.top-n.bottom,K=Math.min(F,J)/2,P=K-(K/5),T=d3.select(this);nv.utils.initSVG(T);var S=T.selectAll(".nv-wrap.nv-pie").data(ad);var M=S.enter().append("g").attr("class","nvd3 nv-wrap nv-pie nv-chart-"+q);var W=M.append("g");var X=S.select("g");var L=W.append("g").attr("class","nv-pie");W.append("g").attr("class","nv-pieLabels");S.attr("transform","translate("+n.left+","+n.top+")");X.select(".nv-pie").attr("transform","translate("+F/2+","+J/2+")");X.select(".nv-pieLabels").attr("transform","translate("+F/2+","+J/2+")");T.on("click",function(af,ae){A.chartClick({data:af,index:ae,pos:d3.event,id:q})});var Q=d3.svg.arc().outerRadius(P);var Z=d3.svg.arc().outerRadius(P+5);if(w){Q.startAngle(w);Z.startAngle(w)}if(r){Q.endAngle(r);Z.endAngle(r)}if(j){Q.innerRadius(K*l);Z.innerRadius(K*l)}var U=d3.layout.pie().sort(null).value(function(ae){return ae.disabled?0:x(ae)});if(U.padAngle&&k){U.padAngle(k)}if(Q.cornerRadius&&e){Q.cornerRadius(e);Z.cornerRadius(e)}if(j&&C){var E=L.append("g").attr("class","nv-pie");E.append("text").style("text-anchor","middle").attr("class","nv-pie-title").text(function(ae){return C}).attr("dy","0.35em").attr("transform",function(af,ae){return"translate(0, "+c+")"})}var H=S.select(".nv-pie").selectAll(".nv-slice").data(U);var G=S.select(".nv-pieLabels").selectAll(".nv-label").data(U);H.exit().remove();G.exit().remove();var aa=H.enter().append("g");aa.attr("class","nv-slice");aa.on("mouseover",function(af,ae){d3.select(this).classed("hover",true);if(z){d3.select(this).select("path").transition().duration(70).attr("d",Z)}A.elementMouseover({label:y(af.data),value:x(af.data),point:af.data,pointIndex:ae,pos:[d3.event.pageX,d3.event.pageY],id:q,color:d3.select(this).style("fill")})});aa.on("mouseout",function(af,ae){d3.select(this).classed("hover",false);if(z){d3.select(this).select("path").transition().duration(50).attr("d",Q)}A.elementMouseout({label:y(af.data),value:x(af.data),point:af.data,index:ae,id:q})});H.attr("fill",function(af,ae){return u(af,ae)});H.attr("stroke",function(af,ae){return u(af,ae)});var V=aa.append("path").each(function(ae){this._current=ae});V.on("click",function(af,ae){A.elementClick({label:y(af.data),value:x(af.data),point:af.data,index:ae,pos:d3.event,id:q});d3.event.stopPropagation()});V.on("dblclick",function(af,ae){A.elementDblClick({label:y(af.data),value:x(af.data),point:af.data,index:ae,pos:d3.event,id:q});d3.event.stopPropagation()});H.select("path").transition().attr("d",Q).attrTween("d",I);if(p){var N=d3.svg.arc().innerRadius(0);if(i){var N=Q}if(t){N=d3.svg.arc().outerRadius(Q.outerRadius())}G.enter().append("g").classed("nv-label",true).each(function(ag,ae){var af=d3.select(this);af.attr("transform",function(ai){if(b){ai.outerRadius=P+10;ai.innerRadius=P+15;var ah=(ai.startAngle+ai.endAngle)/2*(180/Math.PI);if((ai.startAngle+ai.endAngle)/2<Math.PI){ah-=90}else{ah+=90}return"translate("+N.centroid(ai)+") rotate("+ah+")"}else{ai.outerRadius=K+10;ai.innerRadius=K+15;return"translate("+N.centroid(ai)+")"}});af.append("rect").style("stroke","#fff").style("fill","#fff").attr("rx",3).attr("ry",3);af.append("text").style("text-anchor",b?((ag.startAngle+ag.endAngle)/2<Math.PI?"start":"end"):"middle").style("fill","#fff")});var R={};var ac=14;var O=140;var ab=function(ae){return Math.floor(ae[0]/O)*O+","+Math.floor(ae[1]/ac)*ac};G.watchTransition(f,"pie labels").attr("transform",function(ah){if(b){ah.outerRadius=P+10;ah.innerRadius=P+15;var af=(ah.startAngle+ah.endAngle)/2*(180/Math.PI);if((ah.startAngle+ah.endAngle)/2<Math.PI){af-=90}else{af+=90}return"translate("+N.centroid(ah)+") rotate("+af+")"}else{ah.outerRadius=K+10;ah.innerRadius=K+15;var ae=N.centroid(ah);if(ah.value){var ag=ab(ae);if(R[ag]){ae[1]-=ac}R[ab(ae)]=true}return"translate("+ae+")"}});G.select(".nv-label text").style("text-anchor",b?((d.startAngle+d.endAngle)/2<Math.PI?"start":"end"):"middle").text(function(ag,ae){var af=(ag.endAngle-ag.startAngle)/(2*Math.PI);var ah={key:y(ag.data),value:x(ag.data),percent:g(af)};return(ag.value&&af>v)?ah[B]:""})}function Y(af){var ae=(af.startAngle+af.endAngle)*90/Math.PI-90;return ae>90?ae-180:ae}function I(ae){ae.endAngle=isNaN(ae.endAngle)?0:ae.endAngle;ae.startAngle=isNaN(ae.startAngle)?0:ae.startAngle;if(!j){ae.innerRadius=0}var af=d3.interpolate(this._current,ae);this._current=af(0);return function(ag){return Q(af(ag))}}});f.renderEnd("pie immediate");return m}m.dispatch=A;m.options=nv.utils.optionsFunc.bind(m);m._options=Object.create({},{width:{get:function(){return s},set:function(D){s=D}},height:{get:function(){return o},set:function(D){o=D}},showLabels:{get:function(){return p},set:function(D){p=D}},title:{get:function(){return C},set:function(D){C=D}},titleOffset:{get:function(){return c},set:function(D){c=D}},labelThreshold:{get:function(){return v},set:function(D){v=D}},labelFormat:{get:function(){return g},set:function(D){g=D}},valueFormat:{get:function(){return h},set:function(D){h=D}},x:{get:function(){return y},set:function(D){y=D}},id:{get:function(){return q},set:function(D){q=D}},endAngle:{get:function(){return r},set:function(D){r=D}},startAngle:{get:function(){return w},set:function(D){w=D}},padAngle:{get:function(){return k},set:function(D){k=D}},cornerRadius:{get:function(){return e},set:function(D){e=D}},donutRatio:{get:function(){return l},set:function(D){l=D}},pieLabelsOutside:{get:function(){return i},set:function(D){i=D}},donutLabelsOutside:{get:function(){return t},set:function(D){t=D}},labelSunbeamLayout:{get:function(){return b},set:function(D){b=D}},donut:{get:function(){return j},set:function(D){j=D}},growOnHover:{get:function(){return z},set:function(D){z=D}},margin:{get:function(){return n},set:function(D){n.top=typeof D.top!="undefined"?D.top:n.top;n.right=typeof D.right!="undefined"?D.right:n.right;n.bottom=typeof D.bottom!="undefined"?D.bottom:n.bottom;n.left=typeof D.left!="undefined"?D.left:n.left}},y:{get:function(){return x},set:function(D){x=d3.functor(D)}},color:{get:function(){return u},set:function(D){u=nv.utils.getColor(D)}},labelType:{get:function(){return B},set:function(D){B=D||"key"}}});nv.utils.initOptions(m);return m};nv.models.pieChart=function(){var m=nv.models.pie();var c=nv.models.legend();var o={top:0,right:20,bottom:20,left:20},q=null,p=null,t=true,e=false,r=nv.utils.defaultColor(),b=true,h=function(v,z,x,w){return'<h3 style="background-color: '+x.color+'"><font color="white">'+v+"</font></h3><p>"+z+"</p>"},i=nv.utils.state(),j=null,f="No Data Available.",a=250,u=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState","renderEnd");var g=function(B,v){var w=m.x()(B.point);var A=B.pos[0]+((v&&v.offsetLeft)||0),z=B.pos[1]+((v&&v.offsetTop)||0),C=m.valueFormat()(m.y()(B.point)),x=h(w,C,B,n);nv.tooltip.show([A,z],x,B.value<0?"n":"s",null,v)};var k=nv.utils.renderWatch(u);var l=function(v){return function(){return{active:v.map(function(w){return !w.disabled})}}};var s=function(v){return function(w){if(w.active!==undefined){v.forEach(function(y,x){y.disabled=!w.active[x]})}}};function n(v){k.reset();k.models(m);v.each(function(B){var x=d3.select(this);nv.utils.initSVG(x);var D=this;var G=(q||parseInt(x.style("width"),10)||960)-o.left-o.right,A=(p||parseInt(x.style("height"),10)||400)-o.top-o.bottom;n.update=function(){x.transition().call(n)};n.container=this;i.setter(s(B),n.update).getter(l(B)).update();i.disabled=B.map(function(H){return !!H.disabled});if(!j){var F;j={};for(F in i){if(i[F] instanceof Array){j[F]=i[F].slice(0)}else{j[F]=i[F]}}}if(!B||!B.length){var y=x.selectAll(".nv-noData").data([f]);y.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");y.attr("x",o.left+G/2).attr("y",o.top+A/2).text(function(H){return H});return n}else{x.selectAll(".nv-noData").remove()}var z=x.selectAll("g.nv-wrap.nv-pieChart").data([B]);var w=z.enter().append("g").attr("class","nvd3 nv-wrap nv-pieChart").append("g");var C=z.select("g");w.append("g").attr("class","nv-pieWrap");w.append("g").attr("class","nv-legendWrap");if(t){c.width(G).key(m.x());z.select(".nv-legendWrap").datum(B).call(c);if(o.top!=c.height()){o.top=c.height();A=(p||parseInt(x.style("height"))||400)-o.top-o.bottom}z.select(".nv-legendWrap").attr("transform","translate(0,"+(-o.top)+")")}z.attr("transform","translate("+o.left+","+o.top+")");m.width(G).height(A);var E=C.select(".nv-pieWrap").datum([B]);d3.transition(E).call(m);c.dispatch.on("stateChange",function(I){for(var H in I){i[H]=I[H]}u.stateChange(i);n.update()});m.dispatch.on("elementMouseout.tooltip",function(H){u.tooltipHide(H)});u.on("changeState",function(H){if(typeof H.disabled!=="undefined"){B.forEach(function(J,I){J.disabled=H.disabled[I]});i.disabled=H.disabled}n.update()})});k.renderEnd("pieChart immediate");return n}m.dispatch.on("elementMouseover.tooltip",function(v){v.pos=[v.pos[0]+o.left,v.pos[1]+o.top];u.tooltipShow(v)});u.on("tooltipShow",function(v){if(b){g(v)}});u.on("tooltipHide",function(){if(b){nv.tooltip.cleanup()}});n.legend=c;n.dispatch=u;n.pie=m;n.options=nv.utils.optionsFunc.bind(n);n._options=Object.create({},{noData:{get:function(){return f},set:function(v){f=v}},tooltipContent:{get:function(){return h},set:function(v){h=v}},tooltips:{get:function(){return b},set:function(v){b=v}},showLegend:{get:function(){return t},set:function(v){t=v}},defaultState:{get:function(){return j},set:function(v){j=v}},color:{get:function(){return r},set:function(v){r=v;c.color(r);m.color(r)}},duration:{get:function(){return a},set:function(v){a=v;k.reset(a)}}});nv.utils.inheritOptions(n,m);nv.utils.initOptions(n);return n};